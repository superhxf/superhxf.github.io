# git使用

## 1、git的故事

​	Linus在1991年创建了开源的Linux，从此，Linux系统不断发展，已经成为最大的服务器系统软件。

   Linus虽然创建了Linux，但Linux的壮大是靠全世界热心的志愿者参与的，这么多人在世界各地为Linux编写代码,2002年以前，世界各地的志愿者把源代码文件通过diff的方式发给Linus，然后由Linus本人通过手工方式合并代码,之后使用商业的版本控制系统BitKeeper，2005年的时候，Linus花了两周时间自己用C写了一个分布式版本控制系统，这就是Git！

   集中式和分布式

​    集中式版本控制系统，版本库是集中存放在中央服务器的，而干活的时候，用的都是自己的电脑，所以要先从中央服务器取得最新的版本，然后开始干活，干完活了，再把自己的活推送给中央服务器。

​	分布式版本控制系统根本没有“中央服务器”，每个人的电脑上都是一个完整的版本库，这样，你工作的时候，就不需要联网了，因为版本库就在你自己的电脑上。既然每个人电脑上都有一个完整的版本库，那多个人如何协作呢？比方说你在自己电脑上改了文件A，你的同事也在他的电脑上改了文件A，这时，你们俩之间只需把各自的修改推送给对方，就可以互相看到对方的修改了，实际上，分布式也有一个类似于“中央服务器”的概念。

## 2、git的安装

​	安装地址：<https://git-scm.com/>  直接下载安装即可。

## 3、git 的使用

### 3.1、创建版本库

​	版本库又名仓库，英文名**repository**，你可以简单理解成一个目录，这个目录里面的所有文件都可以被Git管理起来，每个文件的修改、删除，Git都能跟踪，以便任何时刻都可以追踪历史，或者在将来某个时刻可以“还原”。

​	创建命令：

```
$ git init 
```

​    添加一个文件：

```
$ git add . (文件名称)
```

  提交到本地仓库：

```
$ git commit -m "提交信息"
```

  查看仓库的状态：

```
$ git status 
```

查看仓库的历史日志：

```
# git log 默认顺序是从最近到最远 
$ git log
```

### 3.2、版本管理

####     3.2.1、git 版本管理命令

git有很强的版本管理的概念，包括版本提交，前进，回退，比对，状态查看等等操作。

​    查看当前仓库状态：

```
$ git status
```

​	查看某个文件修改内容：

```
$ git diff 文件名称
```

​    重置当前版本：（不仅可以做到回退，HEAD^ 代表上一个，也可以使用commitID 来选择重置当前版本）

```
git reset --hard HEAD^
```

   查看提交号：(这个命令可以每一次执行的命令)

```
$ git reflog 
```

####   3.2.2、git 的工作区和暂存区

​	工作区：我们现在作为仓库的那个目录就是工作区。

​	版本库：工作区有一个隐藏目录`.git`，这个不算工作区，而是Git的版本库。Git的版本库里存了很多东西，其中最重要的就是称为stage（或者叫index）的暂存区，还有Git为我们自动创建的第一个分支`master`，以及指向`master`的一个指针叫`HEAD`。

​	![](images/gitaddcommit.jpg)

​		`git add`命令相当于把文件的修改从工作区添加到暂存区。

​		`git commit` 命令相当于把文件从暂存区提交到版本库。

​         理解了工作区，暂存区，版本库的概念之后，有一种场景就是我本地做了修改，但是我后悔了，不想提交了，可以使用

```
$ git checkout --file
```

​	丢弃现在的修改，git会从最近的一次`git add`或者`git commit`找到并重置工作区的这个文件。

​    如果是`git add` 之后想要回退则需要的命令是：

```
$ git reset HEAD file
```

​     这个命令可以把暂存区的修改撤销，从新放回工作区，此时再配合`git checkout --file`，文件直接 重置为版本库最近一次的提交。

​	 如果提交到版本库，想要撤回呢，就使用`git reset --hard HEAD^` 即可。

​     如果想要删除一个版本库的文件，有两种方式，一种是提交删除，一种是git命令，因为git认为删除也是一种修改。

​	提交删除：

```
$ rm file
$ git add .
$ git commit -m "删除"
```

​	git删除：

```
$ rm file
$ git rm file
$ git commit -m "删除"
```

### 3.3、远程仓库

​	介绍git的时候就提过，git也有一个类似于“中央服务器”的概念，就是远程仓库，其实随便另一个人的仓库都是远程仓库。

​	本地仓库如何关联到远程仓库：

```
$ git remote add origin git@github.com:用户名/项目.git
```

  也可以通过克隆命令将远程仓库的项目克隆到本地仓库：

```
$ git clone xxx.git
```

  本地仓库提交到远程仓库：

```
# 第一次推送 （关联操作）
$ git push -u origin master
# 之后的推送可以直接使用
$ git push origin master
```

### 3.4、git的分支管理

​	看廖雪峰的git教程中举了一个很形象的例子，分支就类似于科幻电影里面的平行宇宙，一个宇宙中的你正在努力的学习git，另一个宇宙的你正在努力的学习svn，两者学习互不干扰，某一天，平行宇宙合并了，结果就是你既学会了git也学会了svn。

#### 	3.4.1、git中创建和合并分支

​	 git有一个时间线的概念，每一个时间线其实就是一个分支，HEAD其实并非是指向了最新的提交，而是指向了分支，而每一个分支才真正的指向了提交，类似于下面的图：

![](images/branch.png)

​	 我们可以想到，master也好，dev也好就是一个指针，HEAD通过指向这个指针，而真正关联到具体的提交。

​    为什么git分支提交，分支合并很快的原因就在这里，比如，dev合并到master分支，直接把master分支这个指针指向dev的地址，然后把HEAD指向改后的master即可。

​     创建分支：

```
$ git branch dev
```

   切换分支：

```
$ git checkout dev
```

   创建并切换分支：

```
$ git checkout -b dev
```

